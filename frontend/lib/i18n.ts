import i18n from "i18next";
import { initReactI18next } from "react-i18next";
import * as Localization from "expo-localization";
import AsyncStorage from "@react-native-async-storage/async-storage";

// Translation resources
const resources = {
  en: {
    translation: {
      "auth.email": "Email",
      "auth.password": "Password",
      "auth.displayName": "Display Name",
      "auth.loginError": "Login failed: {{error}}",
      "auth.loginSuccess": "Login successful!",
      "auth.loggingIn": "Logging in...",
      "auth.registrationError": "Registration failed: {{error}}",
      "auth.registrationSuccess":
        "Registration successful! Check your email for verification.",
      "auth.registering": "Registering...",
      "auth.noAccount": "Don't have an account?",
      "auth.alreadyHaveAccount": "Already have an account?",
      "settings.login": "Log In",
      "settings.register": "Register",
      "settings.logout": "Log Out",
      "settings.privacy": "Privacy",
      "settings.privacyDescription": "Manage data collection and tracking preferences",
      "settings.trackingEnabled": "Enable Learning Tracking",
      "settings.trackingDescription": "When enabled, your learning progress will be saved to your history. You can override this for specific courses.",
      "profile.title": "User Profile",
      "profile.noEmail": "N/A",
      "profile.noDisplayName": "N/A",
      "profile.displayName": "Display Name",
      "profile.email": "Email",
      "profile.notSet": "Not set",
      "profile.editProfile": "Edit Profile",
      "profile.cancel": "Cancel",
      "profile.save": "Save",
      "profile.nameRequired": "Name must be at least 2 characters",
      "profile.selectAvatar": "Select Avatar",
      "profile.changeAvatar": "Change Avatar",
      "profile.bio": "Bio",
      "profile.bioPlaceholder": "Tell us about yourself (max 500 characters)",
      "profile.location": "Location",
      "profile.locationPlaceholder": "City, Country",
      "profile.website": "Website",
      "profile.websitePlaceholder": "https://example.com",
      "profile.dateOfBirth": "Date of Birth",
      "profile.selectDateOfBirth": "Select Date of Birth",
      "profile.nativeLanguage": "Native Language",
      "profile.nativeLanguagePlaceholder": "English, 中文, etc.",
      "profile.learningLanguages": "Learning Languages",
      "profile.addLanguage": "Add Language",
      "profile.language": "Language",
      "profile.level": "Level",
      "profile.removeLanguage": "Remove",
      "profile.level.beginner": "Beginner",
      "profile.level.elementary": "Elementary",
      "profile.level.intermediate": "Intermediate",
      "profile.level.advanced": "Advanced",
      "profile.level.native": "Native",
      "profile.bioTooLong": "Bio must be 500 characters or less",
      "profile.invalidUrl": "Please enter a valid URL",
      // Tabs
      "tabs.home": "Home",
      "tabs.tools": "Toolbox",
      "tabs.progress": "History",
      "tabs.settings": "Settings",

      // Home screen
      "home.title": "BabblinGo",
      "home.lesson": "Lesson {{number}}",
      "home.noLessons": "No lessons found for the Novice level.",
      "home.loadError":
        "Unable to load lessons. Pull to refresh and try again.",
      "home.noDisplay": "No lessons to display.",
      "home.noCourses": "No courses available yet.",
      "home.loadCoursesError":
        "Unable to load courses. Pull to refresh and try again.",
      "home.untitledCourse": "Untitled course",

      // Course screen
      "course.loading": "Loading course...",
      "course.error": "Unable to load course. Try again later.",
      "course.empty": "No lessons available yet.",
      "course.defaultTitle": "Course",
      "course.section.ungrouped": "Lessons",
      "course.trackingDescription": "Track your learning progress for this course.",

      // Tools screen
      "tools.title": "Toolbox",
      "tools.loadError": "Unable to load tools. Pull to refresh and try again.",
      "tools.empty": "No tools are available yet.",

      // Lesson screen
      "lesson.back": "Back",
      "lesson.noModules": "No modules available for this lesson.",
      "lesson.notFound": "Lesson not found.",
      "lesson.loading": "Loading...",
      "lesson.error": "Unable to load lesson. Try again later.",
      "lesson.downloading": "Downloading...",
      "lesson.cache.title": "Cache Management",
      "lesson.cache.status": "Status",
      "lesson.cache.statusFull": "Fully Cached",
      "lesson.cache.statusPartial": "Partially Cached",
      "lesson.cache.statusNone": "Not Cached",
      "lesson.cache.clearTitle": "Clear Cache?",
      "lesson.cache.clearMessage":
        "This will delete all cached media for this lesson.",
      "lesson.cache.cleared": "Cache Cleared",
      "lesson.cache.clearedMessage": "Media files have been removed.",
      "lesson.cache.clearError": "Failed to clear cache.",
      "lesson.cache.redownloadTitle": "Re-download Media?",
      "lesson.cache.redownloadMessage":
        "This will download fresh copies of all media files.",
      "lesson.cache.redownload": "Re-download All",
      "lesson.cache.redownloadError": "Failed to re-download media.",
      "lesson.startLearning": "Start learning",
      "lesson.sessionComplete": "Session complete",
      "lesson.timeSpent": "Time spent",
      "lesson.sessionTarget": "Session target",
      "lesson.startAnother": "Start another session",
      "lesson.modules.audioSlideshow": "Audio Slideshow",
      "lesson.modules.video": "Video",
      "lesson.modules.richPost": "Reading",
      "lesson.modules.audio": "Audio Playlist",
      "lesson.modules.position": "Module {{index}}",
      "lesson.modules.unsupported": "This module type is not supported yet.",
      "lesson.modules.backToList": "Back to modules",
      "lesson.audio.primaryTrack": "Queued in the audio controls.",
      "lesson.audio.additionalTrack": "Tap to play this track.",
      "lesson.audio.missingTrack": "Audio file missing.",
      "lesson.audio.emptyPlaylist": "No tracks available.",
      "lesson.audio.untitledTrack": "Untitled track",
      "lesson.video.preparing": "Preparing video...",
      "lesson.video.error": "Unable to load video.",
      "lesson.video.missing": "Video file is not available.",
      "lesson.video.transcript": "Transcript",
      "lesson.video.controls.play": "Play",
      "lesson.video.controls.pause": "Pause",
      "lesson.video.controls.stop": "Stop",
      "lesson.video.controls.rewind": "Back 10s",
      "lesson.video.controls.forward": "Forward 10s",
      "lesson.video.controls.speed": "Speed",
      "lesson.video.controls.speedLabel": "{{value}}x",
      "lesson.video.controls.mute": "Mute",
      "lesson.video.controls.unmute": "Unmute",
      "lesson.video.controls.fullscreen": "Fullscreen",
      "lesson.video.controls.exitFullscreen": "Exit fullscreen",
      "lesson.video.controls.scrub": "Seek position",

      // Timer
      "timer.set": "Set session timer",
      "timer.minutes": "minutes",
      "timer.seconds": "seconds",
      "timer.close": "Close",
      "timer.cancel": "Cancel timer",
      "timer.start": "Start",
      "timer.restart": "Restart",
      

      // Player
      "player.speed": "Speed",

      // Progress screen
      "progress.title": "History",
      "progress.today": "Today",
      "progress.thisWeek": "This Week",
      "progress.allTime": "All Time",
      "progress.last7days": "Last 7 days",
      "progress.last30days": "Last 30 days",
      "progress.alltime": "All time",
      "progress.allLessons": "All lessons",
      "progress.allCourses": "All courses",
      "progress.weekly": "Weekly",
      "progress.chartTitle7d": "Past 7 days",
      "progress.chartTitle30d": "Weekly totals (last 30 days)",
      "progress.chartTitleAll": "Monthly totals",
      "progress.chartEmpty": "No activity recorded in this range yet.",
      "progress.topLessons": "Top lessons",
      "progress.noData": "No data",
      "progress.sessions": "{{count}} session",
      "progress.sessions_other": "{{count}} sessions",
      "progress.noSessions":
        "No sessions yet. Start a timed session from any lesson to see your learning history here.",
      "progress.sectionToday": "Today",
      "progress.sectionWeek": "This Week",
      "progress.sectionEarlier": "Earlier",
      "progress.delete": "Delete",
      "progress.planned": "planned",
      "progress.actual": "actual",
      "progress.unfinished": "unfinished",
      "progress.totalFiltered": "Total Learning Time",
      "progress.loadingMore": "Loading more…",
      "progress.endOfHistory": "End of history",
  "progress.addManualEntry": "Add manual entry",

  // Manual entry
  "manualEntry.title": "Add manual session",
  "manualEntry.subtitle": "Log time you spent learning outside the app.",
  "manualEntry.lessonLabel": "Lesson or activity",
  "manualEntry.lessonPlaceholder": "Conversation with tutor, podcast, etc.",
  "manualEntry.lessonIdLabel": "Lesson ID (optional)",
  "manualEntry.lessonIdPlaceholder": "Use an existing lesson ID if you have one",
  "manualEntry.lessonIdHint": "Leave blank to create a new manual entry ID.",
  "manualEntry.startLabel": "Start time",
  "manualEntry.endLabel": "End time",
  "manualEntry.endHint": "Sessions must be at least one minute long.",
  "manualEntry.finishedLabel": "Mark as finished",
  "manualEntry.finishedHint": "Turn off if you want to revisit this session later.",
  "manualEntry.notesLabel": "Notes",
  "manualEntry.notesPlaceholder": "What did you practice?",
  "manualEntry.saveButton": "Save entry",
  "manualEntry.saving": "Saving…",
  "manualEntry.successTitle": "Entry saved",
  "manualEntry.successMessage": "We queued this session for sync.",
  "manualEntry.error.invalidTitle": "Please enter a lesson or activity name.",
  "manualEntry.error.endBeforeStart": "End time must be after the start time.",
  "manualEntry.error.invalidDuration": "Session length must be between 1 minute and 8 hours.",
  "manualEntry.error.generic": "Unable to save this entry. Please try again.",
  "manualEntry.backHint": "Go back",
  "manualEntry.linkLessonLabel": "Link to existing lesson",
  "manualEntry.linkLessonNone": "No lesson linked yet.",
  "manualEntry.linkLessonButton": "Search lessons",
  "manualEntry.linkLessonClear": "Remove link",
  "manualEntry.linkLessonHint": "Linking a lesson keeps your manual time tied to the right course.",
  "manualEntry.recentLessons": "Recent lessons",
  "manualEntry.recentEmpty": "Lessons you open from here will appear for quick access.",
  "manualEntry.linkLessonTitle": "Link an existing lesson",
  "manualEntry.linkLessonResultsLabel": "Search results",
  "manualEntry.linkLessonSearchPlaceholder": "Search by lesson or course name",
  "manualEntry.linkLessonSearchEmpty": "We couldn't find any lessons. Try a different search term.",
  "manualEntry.linkLessonUnauthorized": "Sign in again to search lessons.",
  "manualEntry.linkLessonError": "Something went wrong. Please try searching again.",
  "manualEntry.linkedLessonAutoTitle": "We'll use the linked lesson title for this entry.",
  "manualEntry.deleteTitle": "Delete Record",
  "manualEntry.deleteConfirmation": "Are you sure you want to delete this learning record?",

      // Settings
      "settings.title": "Settings",
      "settings.placeholder": "App settings go here",
      "settings.accountSection": "Account",
      "settings.preferencesSection": "Preferences",
      "settings.viewRecords": "View Learning Records",
      "settings.language": "App Language",
      "settings.languageDescription": "Choose the app's language",
      "settings.theme": "Theme",
      "settings.themeDescription": "Select your preferred appearance mode",
      "settings.themeSystem": "System Default",
      "settings.themeLight": "Light",
      "settings.themeDark": "Dark",
      "settings.learningPreferences": "Learning Preferences",
      "settings.learningPreferencesDescription":
        "Default session length and playback speed",
      "settings.system": "System Default",
      "settings.about": "About",
      "settings.about.appName": "BabblinGo",
      "settings.about.tagline": "Learning languages the natural way",
      "settings.about.appDescription": "BabblinGo is your companion for natural language acquisition. Built on proven linguistic principles, our app helps you activate your innate language learning abilities through immersive, comprehensible input.",
      "settings.about.whatWeDo": "What We Do",
      "settings.about.whatWeDoDesc": "We provide structured multimedia learning materials that connect sound with meaning—the essence of language learning. Our courses guide you through the acquisition activation phase with carefully crafted content designed to build your intuitive language skills.",
      "settings.about.features": "Key Features",
      "settings.about.feature1": "Audio-based lessons with adjustable playback speed",
      "settings.about.feature2": "Multi-modal content: audio slideshows, videos, rich text",
      "settings.about.feature3": "Offline caching for learning on the go",
      "settings.about.feature4": "Progress tracking to monitor your journey",
      "settings.about.philosophy": "Our Philosophy",
      "settings.about.philosophyNature": "The Nature of Language",
      "settings.about.philosophyNatureDesc": "Expressing mental representations through sound",
      "settings.about.philosophyLearning": "The Nature of Language Learning",
      "settings.about.philosophyLearningDesc": "Building connections between sound and mental representations",
      "settings.about.philosophyActivation": "Acquisition Activation Phase",
      "settings.about.philosophyActivationDesc": "Activate your LAD properly, learn without detours",
      "settings.about.aboutUs": "About Us",
      "settings.about.aboutUsDesc": "Breaking myths, deconstructing language learning",
      "settings.about.founder1": "Founder - Zhao Jinhai: ",
      "settings.about.founder1Desc": "Teaching Director & Chief Editor, Beijing Olympics Volunteer Language Training",
      "settings.about.founder2": "Founder - Zeng Yi: ",
      "settings.about.founder2Desc": "10-Year Senior Children's English Teacher, Beijing Haidian",
      "settings.about.website": "Official Website",
      "settings.about.company": "Beijing BabblinGuide Culture Communications Co., Ltd.",
      "settings.cache.title": "Media Cache",
      "settings.cache.description": "Cached media files for offline access",
      "settings.cache.files": "Files",
      "settings.cache.size": "Size",
      "settings.cache.clearConfirmTitle": "Clear Cache?",
      "settings.cache.clearConfirmMessage":
        "This will delete all cached media files. They will be re-downloaded when needed.",
      "settings.cache.cleared": "Cache Cleared",
      "settings.cache.clearedMessage": "All cached files have been removed.",
      "settings.cache.clearError": "Failed to clear cache. Please try again.",
      "settings.records.title": "Learning Records",
      "settings.records.description":
        "Manage your learning history and statistics",
      "settings.records.sessions": "Sessions",
      "settings.records.totalTime": "Total Time",
      "settings.records.clearConfirmTitle": "Clear All Records?",
      "settings.records.clearConfirmMessage":
        "This will permanently delete all your learning history. This action cannot be undone.",
      "settings.records.cleared": "Records Cleared",
      "settings.records.clearedMessage":
        "All learning records have been removed.",
      "settings.records.clearError":
        "Failed to clear records. Please try again.",
      "settings.records.warning":
        "Warning: Clearing records will permanently delete all your learning history. This action cannot be undone.",
      "settings.learning.title": "Learning Preferences",
      "settings.learning.sessionLength": "Default Session Length",
      "settings.learning.sessionLengthDesc":
        "How long you plan to study when starting a learning session",
      "settings.learning.playbackSpeed": "Default Playback Speed",
      "settings.learning.playbackSpeedDesc":
        "Audio playback speed for learning sessions",
      "settings.learning.saved": "Saved",
      "settings.learning.savedMessage": "Your preferences have been saved.",
      "settings.learning.saveError": "Failed to save preferences.",
      "settings.learning.setSessionLength": "Session length",
      "settings.learning.setPlaybackSpeed": "Playback speed",

      // Session
      "session.startLearning": "Start Learning Session",
      "session.speed": "speed",
      "session.paused": "PAUSED",
      "session.pause": "Pause",
      "session.resume": "Resume",
      "session.stop": "Stop",

      // Common
      "common.cancel": "Cancel",
      "common.clear": "Clear",
      "common.refresh": "Refresh",
      "common.error": "Error",
      "common.loading": "Loading...",
      "common.saving": "Saving...",
      "common.save": "Save Preferences",
      "common.close": "Close",
      "common.done": "Done",
      "common.tapToEdit": "Edit",
      "common.delete": "Delete",
      "common.exit": "Exit",
      // Weekday labels
      "common.weekdayShort.mon": "Mo",
      "common.weekdayShort.tue": "Tu",
      "common.weekdayShort.wed": "We",
      "common.weekdayShort.thu": "Th",
      "common.weekdayShort.fri": "Fr",
      "common.weekdayShort.sat": "Sa",
      "common.weekdayShort.sun": "Su",
      // Auth - Forgot Password
      "auth.forgotPassword": "Forgot password",
      "auth.sendReset": "Send reset link",
      "auth.resetSent":
        "If an account exists for that email, a reset link has been sent.",
      "auth.resetError": "Failed to send reset email: {{error}}",
      "auth.resetInstructions":
        "Enter your email and we'll send you a link to reset your password.",
      "auth.backToLogin": "Back to login",

      // Agents feature
      "agents.title": "BabblinGears",
      "agents.description": "Interact with AI agents to refine your language skills",
      "agents.noAgents": "No agents available at the moment.",
      "chat.placeholder": "Type a message...",
      "chat.loginRequired": "Please login to chat with agents.",
      "chat.history.title": "History",
      "chat.newChat": "New Chat",
      "chat.untitledConversation": "Untitled Conversation",
      "chat.deleteConversation": "Delete Conversation",
      "chat.deleteConfirmation": "Are you sure you want to delete this conversation?",
      "chat.delete": "Delete",
      "chat.noHistory": "No history found.",
      "chat.thinking": "Thinking...",
      "chat.copiedToClipboard": "Copied to clipboard",
    },
  },
  zh: {
    translation: {
      "auth.email": "邮箱",
      "auth.password": "密码",
      "auth.displayName": "昵称",
      "auth.loginError": "登录失败：{{error}}",
      "auth.loginSuccess": "登录成功！",
      "auth.loggingIn": "正在登录...",
      "auth.registrationError": "注册失败：{{error}}",
      "auth.registrationSuccess": "注册成功！请查收验证邮件。",
      "auth.registering": "正在注册...",
      "auth.noAccount": "还没有账号？",
      "auth.alreadyHaveAccount": "已经有账号？",
      "settings.login": "登录",
      "settings.register": "注册",
      "settings.logout": "退出登录",
      "settings.privacy": "隐私",
      "settings.privacyDescription": "管理数据收集和追踪偏好",
      "settings.trackingEnabled": "启用学习追踪",
      "settings.trackingDescription": "启用后，您的学习进度将被保存到历史记录中。您可以针对特定课程覆盖此设置。",
      "profile.title": "个人信息",
      "profile.noEmail": "无",
      "profile.noDisplayName": "无",
      "profile.displayName": "昵称",
      "profile.email": "邮箱",
      "profile.notSet": "未设置",
      "profile.editProfile": "编辑资料",
      "profile.cancel": "取消",
      "profile.save": "保存",
      "profile.nameRequired": "昵称至少需要2个字符",
      "profile.selectAvatar": "选择头像",
      "profile.changeAvatar": "更换头像",
      "profile.bio": "个人简介",
      "profile.bioPlaceholder": "介绍一下自己（最多500字）",
      "profile.location": "所在地",
      "profile.locationPlaceholder": "城市，国家",
      "profile.website": "个人网站",
      "profile.websitePlaceholder": "https://example.com",
      "profile.dateOfBirth": "出生日期",
      "profile.selectDateOfBirth": "选择出生日期",
      "profile.nativeLanguage": "母语",
      "profile.nativeLanguagePlaceholder": "中文、English 等",
      "profile.learningLanguages": "正在学习的语言",
      "profile.addLanguage": "添加语言",
      "profile.language": "语言",
      "profile.level": "水平",
      "profile.removeLanguage": "移除",
      "profile.level.beginner": "初学",
      "profile.level.elementary": "基础",
      "profile.level.intermediate": "中级",
      "profile.level.advanced": "高级",
      "profile.level.native": "母语",
      "profile.bioTooLong": "个人简介不能超过500字",
      "profile.invalidUrl": "请输入有效的网址",
      // Tabs
      "tabs.home": "首页",
      "tabs.tools": "工具",
      "tabs.progress": "记录",
      "tabs.settings": "设置",

      // Home screen
      "home.title": "BabblinGo",
      "home.lesson": "第 {{number}} 课",
      "home.noLessons": "未找到初级课程。",
      "home.loadError": "无法加载课程。下拉刷新重试。",
      "home.noDisplay": "暂无课程。",
      "home.noCourses": "暂无课程。",
      "home.loadCoursesError": "无法加载课程。下拉刷新重试。",
      "home.untitledCourse": "未命名课程",

      // Tools screen
      "tools.title": "工具箱",
      "tools.loadError": "无法加载工具。下拉刷新后重试。",
      "tools.empty": "暂无可用的工具。",

      // Lesson screen
      "lesson.back": "返回",
      "lesson.noModules": "本课程暂无内容。",
      "lesson.notFound": "未找到课程。",
      "lesson.loading": "加载中...",
      "lesson.error": "无法加载课程。请稍后重试。",
      "lesson.downloading": "下载中...",
      "lesson.cache.title": "缓存管理",
      "lesson.cache.status": "状态",
      "lesson.cache.statusFull": "已完全缓存",
      "lesson.cache.statusPartial": "部分缓存",
      "lesson.cache.statusNone": "未缓存",
      "lesson.cache.clearTitle": "清除缓存？",
      "lesson.cache.clearMessage": "这将删除本课程的所有缓存媒体文件。",
      "lesson.cache.cleared": "缓存已清除",
      "lesson.cache.clearedMessage": "媒体文件已删除。",
      "lesson.cache.clearError": "清除缓存失败。",
      "lesson.cache.redownloadTitle": "重新下载媒体？",
      "lesson.cache.redownloadMessage": "这将重新下载所有媒体文件。",
      "lesson.cache.redownload": "重新下载全部",
      "lesson.cache.redownloadError": "重新下载媒体失败。",
      "lesson.startLearning": "开始练习",
      "lesson.sessionComplete": "练习完成",
      "lesson.timeSpent": "练习时长",
      "lesson.sessionTarget": "计划时长",
      "lesson.startAnother": "再来一次",
      "lesson.modules.audioSlideshow": "音画",
      "lesson.modules.video": "视频",
      "lesson.modules.richPost": "图文",
      "lesson.modules.audio": "音频",
      "lesson.modules.position": "模块{{index}}",
      "lesson.modules.unsupported": "该模块类型尚未支持。",
      "lesson.modules.backToList": "返回模块列表",
      "lesson.audio.primaryTrack": "已在播放器队列中。",
      "lesson.audio.additionalTrack": "点击播放该音频。",
      "lesson.audio.missingTrack": "音频文件缺失。",
      "lesson.audio.emptyPlaylist": "暂无可播放的音频。",
      "lesson.audio.untitledTrack": "未命名音频",
      "lesson.video.preparing": "正在准备视频...",
      "lesson.video.error": "无法加载视频。",
      "lesson.video.missing": "暂无可播放的视频文件。",
      "lesson.video.transcript": "字幕稿",
      "lesson.video.controls.play": "播放",
      "lesson.video.controls.pause": "暂停",
      "lesson.video.controls.stop": "停止",
      "lesson.video.controls.rewind": "后退 10 秒",
      "lesson.video.controls.forward": "前进 10 秒",
      "lesson.video.controls.speed": "播放速度",
      "lesson.video.controls.speedLabel": "{{value}} 倍",
      "lesson.video.controls.mute": "静音",
      "lesson.video.controls.unmute": "取消静音",
      "lesson.video.controls.fullscreen": "全屏",
      "lesson.video.controls.exitFullscreen": "退出全屏",
      "lesson.video.controls.scrub": "拖动进度",

      // Course screen
      "course.loading": "正在加载课程...",
      "course.error": "无法加载课程。请稍后重试。",
      "course.empty": "暂无课程内容。",
      "course.defaultTitle": "课程",
      "course.section.ungrouped": "课程列表",
      "course.trackingDescription": "追踪此课程的学习进度。",

      // Timer
      "timer.set": "设置练习计时",
      "timer.minutes": "分钟",
      "timer.seconds": "秒",
      "timer.close": "关闭",
      "timer.cancel": "取消计时",
      "timer.start": "开始",
      "timer.restart": "重新开始",
      

      // Player
      "player.speed": "速度",

      // Progress screen
      "progress.title": "学习记录",
      "progress.today": "今天",
      "progress.thisWeek": "本周",
      "progress.allTime": "总计",
      "progress.last7days": "最近 7 天",
      "progress.last30days": "最近 30 天",
      "progress.alltime": "全部",
      "progress.allLessons": "全部课程",
      "progress.allCourses": "全部课程",
      "progress.weekly": "本周",
      "progress.chartTitle7d": "最近 7 天",
      "progress.chartTitle30d": "最近 30 天每周总计",
      "progress.chartTitleAll": "最近 12 个月月度总计",
      "progress.chartEmpty": "该时间范围内暂无学习记录。",
      "progress.topLessons": "热门课程",
      "progress.noData": "暂无数据",
      "progress.sessions": "{{count}} 次学习",
      "progress.sessions_other": "{{count}} 次学习",
      "progress.noSessions":
        "暂无学习记录。在任意课程中开始计时学习后，您的学习记录将显示在这里。",
      "progress.sectionToday": "今天",
      "progress.sectionWeek": "本周",
      "progress.sectionEarlier": "更早",
      "progress.addManualEntry": "添加手动记录",
      "progress.delete": "删除",
      "progress.planned": "计划",
      "progress.actual": "实际",
      "progress.unfinished": "未完成",
      "progress.totalFiltered": "学习总时长",
      "progress.loadingMore": "加载更多…",
      "progress.endOfHistory": "已到底部",

  // Manual entry
  "manualEntry.title": "添加手动学习记录",
  "manualEntry.subtitle": "记录您在 App 外的学习时间。",
  "manualEntry.lessonLabel": "课程或活动",
  "manualEntry.lessonPlaceholder": "与老师的对话、播客等",
  "manualEntry.lessonIdLabel": "课程编号（可选）",
  "manualEntry.lessonIdPlaceholder": "如果有现成的课程编号可在此输入",
  "manualEntry.lessonIdHint": "若留空，将为这条手动记录创建新的编号。",
  "manualEntry.startLabel": "开始时间",
  "manualEntry.endLabel": "结束时间",
  "manualEntry.endHint": "学习时长至少需 1 分钟。",
  "manualEntry.finishedLabel": "标记为已完成",
  "manualEntry.finishedHint": "如果想以后再继续，可关闭此选项。",
  "manualEntry.notesLabel": "备注",
  "manualEntry.notesPlaceholder": "练习了哪些内容？",
  "manualEntry.saveButton": "保存记录",
  "manualEntry.saving": "正在保存…",
  "manualEntry.successTitle": "记录已保存",
  "manualEntry.successMessage": "我们已将此学习记录加入同步队列。",
  "manualEntry.error.invalidTitle": "请填写课程或活动名称。",
  "manualEntry.error.endBeforeStart": "结束时间必须晚于开始时间。",
  "manualEntry.error.invalidDuration": "学习时长需在 1 分钟到 8 小时之间。",
  "manualEntry.error.generic": "无法保存此记录，请重试。",
  "manualEntry.backHint": "返回",
  "manualEntry.linkLessonLabel": "关联已有课程",
  "manualEntry.linkLessonNone": "尚未关联课程。",
  "manualEntry.linkLessonButton": "搜索课程",
  "manualEntry.linkLessonClear": "移除关联",
  "manualEntry.linkLessonHint": "关联课程可以将手动时长与正确的课程对应。",
  "manualEntry.recentLessons": "最近的课程",
  "manualEntry.recentEmpty": "在这里打开的课程会显示在快捷列表。",
  "manualEntry.linkLessonTitle": "关联现有课程",
  "manualEntry.linkLessonResultsLabel": "搜索结果",
  "manualEntry.linkLessonSearchPlaceholder": "按课程或课程序号搜索",
  "manualEntry.linkLessonSearchEmpty": "未找到相关课程，请尝试其他关键词。",
  "manualEntry.linkLessonUnauthorized": "请重新登录后再试。",
  "manualEntry.linkLessonError": "搜索出错，请重试。",
  "manualEntry.linkedLessonAutoTitle": "本次记录将使用所选课程的标题。",
  "manualEntry.deleteTitle": "删除记录",
  "manualEntry.deleteConfirmation": "确定要删除这条学习记录吗？",

      // Settings
      "settings.title": "设置",
      "settings.placeholder": "应用设置",
      "settings.accountSection": "账户",
      "settings.preferencesSection": "偏好设置",
      "settings.viewRecords": "查看学习记录",
      "settings.language": "界面语言",
      "settings.languageDescription": "选择应用的界面语言",
      "settings.theme": "主题",
      "settings.themeDescription": "选择您喜欢的外观模式",
      "settings.themeSystem": "跟随系统",
      "settings.themeLight": "浅色",
      "settings.themeDark": "深色",
      "settings.learningPreferences": "学习偏好设置",
      "settings.learningPreferencesDescription": "设置默认的学习时长和播放速度",
      "settings.system": "跟随系统",
      "settings.about": "关于我们",
      "settings.about.appName": "BabblinGo",
      "settings.about.tagline": "用自然的方式学语言",
      "settings.about.appDescription": "BabblinGo是您自然习得语言的学习伙伴。基于成熟的语言学原理，我们的应用通过沉浸式、可理解的输入，帮助您激活与生俱来的语言学习能力。",
      "settings.about.whatWeDo": "我们做什么",
      "settings.about.whatWeDoDesc": "我们提供结构化的多媒体学习材料，将声音与意义联系起来——这正是语言学习的本质。我们的课程通过精心制作的内容引导您激活与生俱来的语言学习能力，旨在培养您的语言技能。",
      "settings.about.features": "核心功能",
      "settings.about.feature1": "支持调速的音频课程",
      "settings.about.feature2": "多种内容形式：音频幻灯、视频、图文",
      "settings.about.feature3": "离线缓存，随时随地学习",
      "settings.about.feature4": "学习进度跟踪，记录您的成长",
      "settings.about.philosophy": "我们的理念",
      "settings.about.philosophyNature": "语言的本质",
      "settings.about.philosophyNatureDesc": "用声音来表达意象",
      "settings.about.philosophyLearning": "语言学习的本质",
      "settings.about.philosophyLearningDesc": "建立声音与意象的连接",
      "settings.about.philosophyActivation": "习得激活期",
      "settings.about.philosophyActivationDesc": "搞定习得激活期，不怕走弯路",
      "settings.about.aboutUs": "关于我们",
      "settings.about.aboutUsDesc": "破除迷思，解构语言学习",
      "settings.about.founder1": "创始人 - 赵金海：",
      "settings.about.founder1Desc": "北京奥运会志愿者外语培训教学总监、教材主编",
      "settings.about.founder2": "创始人 - 曾易：",
      "settings.about.founder2Desc": "北京海淀10年资深少儿英语教师",
      "settings.about.website": "官方网站",
      "settings.about.company": "北京巴布林文化传播有限公司",
      "settings.cache.title": "媒体缓存",
      "settings.cache.description": "已缓存的媒体文件，可离线访问",
      "settings.cache.files": "文件数",
      "settings.cache.size": "大小",
      "settings.cache.clearConfirmTitle": "清除缓存？",
      "settings.cache.clearConfirmMessage":
        "这将删除所有缓存的媒体文件。需要时会重新下载。",
      "settings.cache.cleared": "缓存已清除",
      "settings.cache.clearedMessage": "所有缓存文件已删除。",
      "settings.cache.clearError": "清除缓存失败，请重试。",
      "settings.records.title": "学习记录",
      "settings.records.description": "管理您的学习历史和统计数据",
      "settings.records.sessions": "学习次数",
      "settings.records.totalTime": "总时长",
      "settings.records.clearConfirmTitle": "清除全部记录？",
      "settings.records.clearConfirmMessage":
        "这将永久删除您的所有学习历史记录。此操作无法撤销。",
      "settings.records.cleared": "记录已清除",
      "settings.records.clearedMessage": "所有学习记录已删除。",
      "settings.records.clearError": "清除记录失败，请重试。",
      "settings.records.warning":
        "警告：清除记录将永久删除您的所有学习历史。此操作无法撤销。",
      "settings.learning.title": "学习偏好设置",
      "settings.learning.sessionLength": "默认学习时长",
      "settings.learning.sessionLengthDesc": "开始学习时的默认时长",
      "settings.learning.playbackSpeed": "默认播放速度",
      "settings.learning.playbackSpeedDesc": "学习时音频的默认播放速度",
      "settings.learning.saved": "已保存",
      "settings.learning.savedMessage": "您的偏好设置已保存。",
      "settings.learning.saveError": "保存偏好设置失败。",
      "settings.learning.setSessionLength": "学习时长",
      "settings.learning.setPlaybackSpeed": "播放速度",

      // Session
      "session.startLearning": "开始学习",
      "session.speed": "速度",
      "session.paused": "已暂停",
      "session.pause": "暂停",
      "session.resume": "继续",
      "session.stop": "停止",

      // Common
      "common.cancel": "取消",
      "common.clear": "清除",
      "common.refresh": "刷新",
      "common.error": "错误",
      "common.loading": "加载中...",
      "common.saving": "保存中...",
      "common.save": "保存偏好设置",
      "common.close": "关闭",
      "common.done": "完成",
      "common.tapToEdit": "编辑",
      "common.delete": "删除",
      "common.exit": "退出",
      // Weekday labels
      "common.weekdayShort.mon": "周一",
      "common.weekdayShort.tue": "周二",
      "common.weekdayShort.wed": "周三",
      "common.weekdayShort.thu": "周四",
      "common.weekdayShort.fri": "周五",
      "common.weekdayShort.sat": "周六",
      "common.weekdayShort.sun": "周日",
      // Auth - Forgot Password
      "auth.forgotPassword": "忘记密码",
      "auth.sendReset": "发送重置链接",
      "auth.resetSent": "如果该邮箱有账号，我们已发送密码重置邮件。",
      "auth.resetError": "发送重置邮件失败：{{error}}",
      "auth.resetInstructions": "请输入您的邮箱，我们会发送密码重置链接。",
      "auth.backToLogin": "返回登录",

      // Agents feature
      "agents.title": "AI智能助手",
      "agents.description": "与AI智能体互动，提升您的语言能力",
      "agents.noAgents": "暂时没有可用的智能体。",
      "chat.placeholder": "输入消息...",
      "chat.loginRequired": "请登录后与智能体聊天。",
      "chat.history.title": "历史记录",
      "chat.newChat": "新对话",
      "chat.untitledConversation": "未命名对话",
      "chat.deleteConversation": "删除对话",
      "chat.deleteConfirmation": "确定要删除这个对话吗？",
      "chat.delete": "删除",
      "chat.noHistory": "暂无历史记录。",
      "chat.thinking": "思考中...",
      "chat.copiedToClipboard": "已复制到剪贴板",
    },
  },
};

const STORAGE_KEY = "app.language";

// Initialize i18n
const initI18n = async () => {
  let savedLanguage: string | null = null;
  try {
    savedLanguage = await AsyncStorage.getItem(STORAGE_KEY);
  } catch {}

  const systemLocale = Localization.getLocales()[0]?.languageCode || "en";
  const fallbackLng = systemLocale.startsWith("zh") ? "zh" : "en";

  // eslint-disable-next-line import/no-named-as-default-member
  await i18n.use(initReactI18next).init({
    resources,
    lng: savedLanguage || fallbackLng,
    fallbackLng: "en",
    interpolation: {
      escapeValue: false,
    },
    compatibilityJSON: "v4",
  });
};

// Change language and persist
export const changeLanguage = async (lang: string) => {
  // eslint-disable-next-line import/no-named-as-default-member
  await i18n.changeLanguage(lang);
  try {
    await AsyncStorage.setItem(STORAGE_KEY, lang);
  } catch {}
};

initI18n();

export default i18n;
